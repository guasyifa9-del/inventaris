<?php
 goto Qctgm; lJEIx: if (!$pembayaran) { setFlashMessage("\144\141\156\147\145\162", "\104\x61\164\x61\x20\x70\145\155\142\141\171\141\162\141\x6e\x20\x74\151\x64\x61\x6b\40\x64\151\164\x65\x6d\x75\x6b\141\156\x20\141\164\141\x75\40\163\x75\144\141\x68\40\144\x69\160\162\157\x73\145\163"); header("\x4c\x6f\x63\141\164\151\157\x6e\x3a\x20\151\x6e\144\145\170\56\160\150\160\x3f\x74\x61\142\x3d\x76\145\x72\x69\x66\151\153\141\x73\x69"); die; } goto zlxWJ; wi1ch: try { if ($action == "\141\x70\x70\162\157\166\x65") { $update_pembayaran = "\12\x20\40\x20\x20\40\x20\40\40\x20\x20\40\40\125\120\104\x41\124\x45\40\160\x65\x6d\x62\141\171\141\x72\141\x6e\x5f\x64\145\156\144\141\40\xa\x20\x20\40\40\40\40\40\40\40\x20\x20\40\123\105\124\x20\163\164\x61\x74\165\163\40\75\x20\x27\166\x65\162\151\146\x69\x65\x64\47\x2c\12\40\40\40\x20\x20\x20\x20\x20\40\x20\x20\x20\40\40\40\40\166\x65\162\151\146\151\145\x64\137\142\x79\40\x3d\40\x3f\54\12\40\x20\40\x20\40\40\40\40\40\x20\40\40\x20\x20\40\40\166\x65\x72\151\146\x69\x65\x64\x5f\141\x74\x20\x3d\x20\116\117\127\x28\x29\x2c\12\40\x20\40\x20\x20\x20\x20\40\x20\40\40\40\40\40\40\40\165\x70\144\141\164\x65\x64\x5f\x61\x74\x20\75\40\x4e\117\127\50\x29\12\x20\x20\x20\40\40\40\x20\40\40\x20\40\x20\127\x48\105\x52\x45\40\160\x65\155\142\141\171\x61\x72\x61\x6e\x5f\x69\144\x20\75\40\x3f\12\x20\40\x20\40\x20\40\40\x20"; $stmt = mysqli_prepare($connection, $update_pembayaran); mysqli_stmt_bind_param($stmt, "\x69\151", $admin["\165\163\145\x72\x5f\x69\x64"], $pembayaran_id); if (!mysqli_stmt_execute($stmt)) { throw new Exception("\107\x61\147\x61\x6c\x20\165\x70\x64\141\164\145\40\160\145\x6d\142\x61\x79\141\162\x61\x6e"); } mysqli_stmt_close($stmt); $update_tagihan = "\xa\x20\x20\40\40\x20\x20\x20\40\40\40\40\40\x55\120\x44\x41\x54\105\40\164\141\x67\151\x68\x61\x6e\137\x64\x65\x6e\144\141\x20\xa\x20\x20\x20\40\40\x20\40\x20\x20\40\40\x20\x53\105\x54\x20\x73\x74\141\164\165\163\40\x3d\40\x27\x70\x61\151\x64\47\x2c\12\40\x20\x20\40\x20\x20\40\x20\x20\40\40\x20\40\x20\x20\40\165\160\144\x61\x74\x65\144\x5f\141\164\x20\75\x20\x4e\x4f\127\50\x29\12\x20\x20\x20\x20\40\x20\40\40\40\40\40\40\127\110\x45\122\x45\x20\164\141\x67\151\x68\141\x6e\137\151\x64\x20\x3d\x20\x3f\12\40\40\40\x20\40\40\x20\40"; $stmt = mysqli_prepare($connection, $update_tagihan); mysqli_stmt_bind_param($stmt, "\x69", $pembayaran["\x74\141\147\151\x68\x61\x6e\x5f\x69\x64"]); if (!mysqli_stmt_execute($stmt)) { throw new Exception("\x47\x61\147\x61\x6c\40\165\x70\x64\141\164\145\x20\x74\x61\147\151\150\141\156"); } mysqli_stmt_close($stmt); $total_tagihan = $pembayaran["\164\157\x74\x61\x6c\137\x74\141\147\x69\x68\141\x6e"]; $deposit_awal = $pembayaran["\x62\151\141\171\x61\137\144\145\160\x6f\163\151\x74"]; $deposit_dikembalikan = max(0, $deposit_awal - $total_tagihan); $insert_pengembalian = "\12\40\40\40\40\40\x20\x20\x20\40\x20\40\x20\111\116\123\x45\122\124\40\111\x4e\124\117\x20\160\x65\156\147\145\x6d\x62\x61\x6c\151\x61\x6e\x20\12\x20\40\40\x20\40\x20\40\40\40\40\40\40\x28\x70\x65\155\x69\x6e\152\141\x6d\x61\156\x5f\x69\144\54\40\x74\141\x6e\147\147\x61\x6c\x5f\x70\145\x6e\147\x65\x6d\142\141\154\151\141\x6e\54\x20\x64\x69\164\145\162\x69\x6d\x61\x5f\157\154\x65\x68\54\40\x6b\157\x6e\x64\151\x73\x69\x5f\165\x6d\x75\155\x2c\12\40\x20\40\x20\x20\x20\x20\x20\40\40\x20\40\142\x69\141\x79\141\137\x70\x65\162\x62\x61\151\x6b\x61\x6e\x2c\x20\144\x65\160\157\163\x69\x74\137\141\167\141\154\x2c\40\x64\x65\x70\157\x73\151\x74\x5f\144\151\x70\x6f\164\157\156\x67\x2c\40\144\145\x70\157\x73\x69\164\x5f\x64\151\x6b\145\155\x62\x61\154\x69\153\x61\x6e\54\xa\40\x20\40\x20\x20\40\x20\40\40\40\40\x20\143\x61\164\141\x74\x61\x6e\x5f\153\x65\x72\x75\x73\141\x6b\x61\156\51\12\40\40\x20\x20\40\40\x20\x20\40\40\x20\x20\126\x41\x4c\125\105\123\x20\50\x3f\54\40\x4e\x4f\127\x28\x29\x2c\x20\x3f\54\40\77\x2c\x20\77\x2c\x20\x3f\x2c\x20\x3f\x2c\40\77\x2c\x20\77\x29\xa\40\x20\40\40\40\40\40\x20"; $biaya_total = $pembayaran["\x62\x69\141\171\141\137\x6b\x65\162\x75\x73\141\153\x61\156"] + $pembayaran["\x62\151\x61\x79\x61\x5f\x6b\145\150\x69\154\x61\x6e\x67\x61\x6e"]; $kondisi_barang = $pembayaran["\x6b\157\156\144\x69\163\x69\x5f\142\141\162\x61\x6e\x67"] ?? "\102\x61\x69\x6b"; $catatan_admin = $pembayaran["\143\141\x74\141\164\x61\x6e\x5f\141\x64\x6d\x69\x6e"] ?? "\55"; $stmt = mysqli_prepare($connection, $insert_pengembalian); mysqli_stmt_bind_param($stmt, "\151\151\x73\144\144\x64\x64\163", $pembayaran["\160\145\x6d\x69\x6e\152\141\x6d\141\156\137\x69\x64"], $admin["\x75\x73\145\162\137\x69\x64"], $kondisi_barang, $biaya_total, $deposit_awal, $total_tagihan, $deposit_dikembalikan, $catatan_admin); if (!mysqli_stmt_execute($stmt)) { throw new Exception("\107\141\x67\141\154\40\x69\x6e\163\145\x72\x74\x20\160\x65\156\x67\x65\x6d\x62\x61\154\151\x61\x6e\x3a\x20" . mysqli_error($connection)); } mysqli_stmt_close($stmt); $update_peminjaman = "\12\40\x20\40\40\40\x20\x20\40\x20\40\x20\x20\125\120\x44\101\x54\105\40\160\145\155\x69\156\x6a\141\155\141\156\x20\12\x20\x20\40\x20\40\x20\x20\x20\40\40\40\40\x53\x45\x54\x20\163\x74\x61\164\x75\163\x20\x3d\40\x27\162\145\x74\x75\x72\x6e\145\144\47\x2c\xa\x20\x20\40\40\x20\40\40\40\40\x20\x20\40\40\40\x20\x20\x75\160\144\141\164\x65\144\137\141\x74\40\75\40\116\117\127\50\51\12\x20\40\40\40\x20\40\x20\40\x20\40\x20\x20\x57\x48\x45\122\x45\40\160\x65\x6d\x69\156\x6a\x61\x6d\x61\156\137\x69\144\x20\x3d\x20\77\xa\40\40\x20\40\40\x20\40\x20"; $stmt = mysqli_prepare($connection, $update_peminjaman); mysqli_stmt_bind_param($stmt, "\x69", $pembayaran["\x70\145\x6d\x69\156\152\x61\x6d\141\x6e\x5f\151\x64"]); if (!mysqli_stmt_execute($stmt)) { throw new Exception("\x47\141\147\x61\154\40\x75\x70\144\141\x74\x65\x20\160\x65\155\151\x6e\x6a\x61\155\x61\x6e"); } mysqli_stmt_close($stmt); $details_query = "\123\105\114\x45\x43\x54\x20\x2a\x20\106\122\117\x4d\40\x70\x65\155\151\156\152\x61\155\x61\156\x5f\x64\x65\x74\141\x69\154\40\x57\110\105\122\105\40\x70\145\x6d\151\156\152\x61\x6d\141\x6e\x5f\x69\x64\x20\x3d\x20\x3f"; $stmt = mysqli_prepare($connection, $details_query); mysqli_stmt_bind_param($stmt, "\151", $pembayaran["\160\145\155\151\156\x6a\141\x6d\141\x6e\x5f\151\x64"]); mysqli_stmt_execute($stmt); $details_result = mysqli_stmt_get_result($stmt); while ($detail = mysqli_fetch_assoc($details_result)) { $update_stock = "\xa\x20\x20\x20\40\x20\40\x20\40\x20\x20\x20\40\40\40\40\x20\125\120\x44\x41\x54\105\40\142\141\162\x61\156\x67\40\12\40\40\40\40\40\40\40\40\x20\40\x20\40\40\40\40\x20\x53\105\124\40\152\165\155\x6c\x61\150\x5f\164\145\162\163\x65\x64\151\141\40\75\40\152\165\x6d\x6c\141\x68\x5f\x74\145\x72\163\145\x64\x69\x61\40\x2b\x20\x3f\12\40\40\40\40\40\x20\40\40\x20\40\40\x20\40\x20\40\x20\x57\110\x45\x52\105\40\x62\141\162\x61\x6e\x67\137\151\x64\x20\75\40\x3f\12\40\x20\x20\x20\x20\40\40\40\x20\40\x20\x20"; $stmt2 = mysqli_prepare($connection, $update_stock); mysqli_stmt_bind_param($stmt2, "\x69\151", $detail["\152\x75\x6d\154\x61\x68"], $detail["\142\141\162\141\x6e\x67\137\151\x64"]); mysqli_stmt_execute($stmt2); mysqli_stmt_close($stmt2); } mysqli_stmt_close($stmt); mysqli_commit($connection); logActivity("\x56\105\122\111\x46\111\x4b\101\123\x49\x5f\120\x45\x4d\102\101\x59\101\122\101\116", "\126\x65\x72\151\x66\151\153\x61\x73\151\x20\x70\145\x6d\142\141\171\x61\x72\141\x6e\72\40{$pembayaran["\153\157\x64\x65\x5f\x70\145\155\x69\x6e\x6a\x61\155\x61\156"]}\40\x2d\40" . formatRupiah($pembayaran["\164\157\x74\x61\x6c\x5f\x74\141\x67\151\x68\x61\156"])); setFlashMessage("\163\x75\x63\x63\x65\163\x73", "\120\145\155\142\x61\171\x61\162\141\x6e\40\x62\145\162\x68\x61\163\x69\154\x20\144\x69\166\x65\162\151\x66\151\x6b\141\x73\x69\41\40\x50\145\156\x67\x65\x6d\x62\141\154\151\141\156\40\x75\156\164\x75\x6b\x20" . $pembayaran["\153\x6f\144\x65\x5f\x70\x65\x6d\x69\156\x6a\x61\x6d\141\156"] . "\40\x74\x65\x6c\x61\x68\x20\163\x65\x6c\x65\x73\141\x69\56\40\x44\145\160\157\163\x69\164\x20\x64\x69\153\145\x6d\142\x61\154\151\153\141\156\72\40" . formatRupiah($deposit_dikembalikan)); header("\114\157\143\x61\164\151\157\x6e\x3a\40\151\156\144\x65\170\56\160\150\x70\77\164\141\142\x3d\141\160\160\x72\157\166\145\x64"); die; } elseif ($action == "\x72\x65\x6a\x65\x63\x74") { $catatan_reject = "\102\165\153\x74\x69\x20\160\145\155\142\141\171\141\x72\141\156\x20\164\x69\144\x61\153\40\x76\141\x6c\151\144\x20\x61\x74\141\x75\40\x74\x69\x64\x61\153\x20\x73\145\163\x75\x61\151\x2e\40\x53\151\x6c\x61\153\x61\156\40\x75\x70\154\157\141\x64\40\x75\154\x61\156\x67\x20\x62\165\x6b\x74\151\x20\x79\x61\x6e\147\x20\142\x65\156\141\162\56"; $update_pembayaran = "\xa\x20\x20\40\40\40\x20\x20\x20\x20\40\40\40\125\120\x44\101\124\105\40\160\x65\155\142\141\x79\x61\x72\141\156\137\x64\145\x6e\x64\x61\40\12\x20\40\x20\40\x20\x20\x20\40\40\x20\40\x20\123\105\124\x20\x73\164\141\x74\165\163\x20\75\40\x27\162\x65\152\145\143\x74\145\144\47\x2c\xa\40\x20\x20\x20\40\x20\x20\x20\40\40\x20\x20\40\x20\x20\x20\x76\145\x72\151\146\151\x65\x64\137\142\171\x20\x3d\40\x3f\x2c\xa\40\x20\x20\x20\x20\x20\40\40\40\40\x20\x20\x20\40\40\40\x76\x65\x72\151\146\151\x65\x64\x5f\141\x74\40\x3d\40\x4e\x4f\127\x28\51\x2c\xa\40\x20\x20\x20\x20\40\40\40\40\40\x20\40\40\40\x20\40\143\141\164\x61\164\141\x6e\x20\x3d\x20\77\54\12\40\40\x20\40\40\40\x20\40\40\40\x20\x20\40\40\x20\40\165\160\x64\x61\164\x65\x64\x5f\141\x74\40\x3d\x20\x4e\117\127\x28\x29\xa\40\40\40\40\40\x20\40\40\x20\40\x20\x20\127\110\x45\x52\x45\40\x70\x65\x6d\x62\x61\x79\x61\x72\x61\156\137\x69\144\40\75\40\77\xa\x20\40\40\x20\40\x20\x20\40"; $stmt = mysqli_prepare($connection, $update_pembayaran); mysqli_stmt_bind_param($stmt, "\151\x73\151", $admin["\x75\163\145\x72\x5f\151\x64"], $catatan_reject, $pembayaran_id); if (!mysqli_stmt_execute($stmt)) { throw new Exception("\x47\141\x67\x61\154\40\165\160\x64\x61\x74\x65\40\160\145\x6d\x62\141\x79\x61\162\141\x6e\x3a\40" . mysqli_error($connection)); } mysqli_stmt_close($stmt); $update_tagihan = "\12\x20\40\40\x20\40\40\40\x20\40\40\x20\x20\125\120\x44\x41\124\105\x20\164\x61\x67\151\x68\x61\156\137\144\145\156\144\141\40\12\40\40\40\40\x20\x20\x20\40\40\x20\40\x20\x53\x45\x54\x20\163\x74\x61\x74\165\163\x20\75\40\x27\165\x6e\x70\x61\151\x64\x27\12\x20\x20\x20\x20\40\40\40\40\40\x20\40\x20\127\x48\x45\122\105\x20\x74\x61\x67\x69\x68\141\156\x5f\x69\144\x20\75\x20\x3f\xa\x20\x20\40\40\40\40\40\x20"; $stmt = mysqli_prepare($connection, $update_tagihan); mysqli_stmt_bind_param($stmt, "\151", $pembayaran["\x74\141\147\x69\150\x61\x6e\x5f\x69\144"]); mysqli_stmt_execute($stmt); mysqli_stmt_close($stmt); mysqli_commit($connection); logActivity("\x52\105\x4a\x45\103\124\x5f\x50\105\x4d\102\101\131\101\x52\101\x4e", "\x54\x6f\154\x61\x6b\40\x70\x65\155\142\141\171\x61\162\x61\156\x3a\40{$pembayaran["\153\157\144\x65\137\160\x65\x6d\x69\x6e\152\x61\x6d\x61\x6e"]}"); setFlashMessage("\x77\141\x72\156\x69\156\x67", "\x50\x65\x6d\142\x61\x79\x61\162\141\156\40\165\x6e\164\x75\x6b\x20" . $pembayaran["\153\157\x64\x65\x5f\160\145\x6d\151\x6e\x6a\141\155\x61\x6e"] . "\40\144\x69\164\157\154\141\x6b\x2e\40\x55\x73\145\x72\x20\160\145\x72\x6c\x75\40\x6d\x65\156\147\x61\152\165\153\141\156\40\x70\x65\x6d\142\141\171\141\162\141\156\40\x75\x6c\141\x6e\147\x20\x64\145\x6e\147\x61\x6e\40\142\165\153\x74\151\40\x79\141\x6e\x67\40\x76\141\x6c\x69\x64\56"); header("\114\x6f\143\x61\164\x69\x6f\x6e\x3a\x20\151\156\144\x65\170\x2e\160\x68\160\x3f\164\141\142\75\x72\x65\x6a\x65\143\164\145\x64"); die; } } catch (Exception $e) { mysqli_rollback($connection); setFlashMessage("\x64\x61\156\x67\145\x72", "\105\162\162\157\x72\x3a\x20" . $e->getMessage()); header("\x4c\157\143\x61\x74\151\x6f\x6e\x3a\x20\151\156\x64\x65\x78\x2e\x70\x68\160\x3f\164\x61\x62\x3d\x76\145\162\151\146\x69\x6b\141\163\151"); die; } goto dtWFX; Qctgm: session_start(); goto N7Awk; UmDGN: if (!$pembayaran_id || !in_array($action, array("\141\160\x70\162\157\166\x65", "\162\145\152\x65\x63\x74"))) { setFlashMessage("\144\x61\156\147\x65\162", "\120\141\x72\x61\155\145\164\x65\x72\x20\164\x69\144\x61\x6b\40\x76\141\x6c\x69\144"); header("\114\157\143\x61\x74\x69\157\x6e\72\x20\x69\x6e\x64\145\x78\x2e\x70\150\x70\x3f\164\141\x62\x3d\x76\145\162\151\146\151\153\141\x73\151"); die; } goto FoZBj; BfTQD: mysqli_stmt_bind_param($stmt, "\151", $pembayaran_id); goto WSt7F; zlxWJ: mysqli_begin_transaction($connection); goto wi1ch; JaFSd: require_once __DIR__ . "\x2f\56\56\57\56\x2e\x2f\x6c\151\x62\57\146\165\156\x63\x74\151\x6f\x6e\x73\56\x70\x68\160"; goto yr6KG; AWbhN: $action = $_GET["\141\143\164\151\157\x6e"] ?? ''; goto UmDGN; WiPzF: $pembayaran = mysqli_fetch_assoc($result); goto Qcksp; OiTCH: $result = mysqli_stmt_get_result($stmt); goto WiPzF; EoLOy: requireAdmin(); goto VK11X; N7Awk: require_once __DIR__ . "\57\x2e\x2e\57\x2e\x2e\x2f\x63\157\156\x66\151\x67\57\144\141\164\141\142\x61\163\x65\56\160\x68\160"; goto JaFSd; yr6KG: require_once __DIR__ . "\x2f\56\x2e\x2f\56\x2e\57\154\x69\x62\57\x61\x75\x74\x68\x2e\160\150\x70"; goto EoLOy; yiG7L: $pembayaran_id = $_GET["\x69\x64"] ?? 0; goto AWbhN; FoZBj: $query = "\xa\40\x20\x20\40\x53\105\114\105\103\x54\40\x70\144\56\x2a\54\40\12\40\x20\40\x20\x20\x20\x20\40\x70\x2e\153\157\144\x65\137\160\x65\x6d\151\x6e\x6a\141\x6d\x61\x6e\x2c\12\x20\40\x20\x20\x20\x20\x20\40\x70\56\x70\x65\x6d\151\x6e\152\141\155\141\156\137\151\144\x2c\xa\x20\x20\40\40\x20\x20\x20\40\160\56\142\151\x61\171\x61\x5f\144\x65\x70\x6f\163\x69\x74\x2c\12\x20\x20\40\x20\40\40\40\40\x70\56\x75\x73\x65\x72\137\x69\144\54\xa\40\40\40\40\x20\x20\x20\40\x74\56\x74\x61\x67\151\150\x61\156\x5f\x69\144\54\xa\40\40\x20\40\x20\40\40\x20\x74\56\164\157\164\x61\x6c\137\164\141\147\151\x68\141\x6e\54\xa\40\x20\x20\x20\x20\x20\x20\40\x74\56\144\x65\156\x64\x61\137\153\145\164\x65\162\154\x61\155\142\141\x74\141\x6e\54\12\40\x20\40\40\40\x20\40\x20\164\x2e\142\x69\141\171\x61\137\x6b\x65\162\165\x73\x61\x6b\141\156\x2c\xa\x20\x20\x20\40\x20\40\40\x20\x74\x2e\x62\151\141\171\x61\137\153\145\150\151\154\141\x6e\x67\x61\x6e\54\12\40\40\40\40\x20\40\x20\40\x74\x2e\x6b\157\156\x64\x69\163\x69\x5f\x62\141\162\141\156\147\54\xa\x20\40\40\40\40\x20\x20\x20\x74\56\143\141\164\x61\x74\141\x6e\x5f\141\144\x6d\151\156\12\x20\40\x20\40\106\x52\x4f\x4d\x20\x70\x65\155\142\x61\x79\141\162\x61\156\137\144\145\x6e\x64\x61\40\x70\x64\40\xa\x20\x20\40\x20\x4c\x45\106\124\x20\112\x4f\111\x4e\x20\160\145\x6d\x69\156\152\141\x6d\x61\x6e\x20\160\x20\117\x4e\x20\x70\x64\56\160\x65\x6d\151\156\152\141\x6d\x61\156\137\151\x64\x20\75\40\x70\56\x70\145\155\151\x6e\x6a\x61\x6d\141\156\x5f\x69\144\12\40\x20\40\40\x4c\105\x46\124\x20\112\x4f\111\x4e\x20\164\141\x67\151\150\141\156\x5f\144\x65\156\x64\x61\x20\x74\x20\x4f\x4e\x20\160\144\56\x74\x61\147\x69\x68\x61\x6e\x5f\x69\x64\x20\75\x20\x74\x2e\164\141\147\x69\x68\141\156\x5f\x69\144\12\x20\x20\x20\40\x57\x48\x45\122\105\x20\x70\x64\56\x70\x65\155\142\x61\x79\141\162\x61\156\137\x69\144\x20\x3d\40\x3f\x20\x41\x4e\104\x20\x70\x64\56\163\x74\x61\x74\x75\x73\x20\x3d\x20\47\x70\x65\156\x64\151\156\147\x27\xa"; goto B4Qjr; WSt7F: mysqli_stmt_execute($stmt); goto OiTCH; B4Qjr: $stmt = mysqli_prepare($connection, $query); goto BfTQD; Qcksp: mysqli_stmt_close($stmt); goto lJEIx; VK11X: $admin = getCurrentUser(); goto yiG7L; dtWFX: ?>