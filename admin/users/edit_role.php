<?php
 goto Kwl1k; XwfsZ: ?>
<div class="mb-4 card"><div class="bg-primary card-header text-white"><h5 class="mb-0">Informasi User</h5></div><div class="card-body"><form class="needs-validation"method="POST"><div class="row mb-3"><div class="col-md-6"><label class="form-label">Username <span class="text-danger">*</span></label> <input class="form-control"value="<?php  goto OO32q; Kuv_6: echo $edit_user["\152\x65\156\x69\x73\x5f\160\145\156\147\147\165\156\141"] === "\141\144\155\151\x6e" ? "\163\x65\154\145\143\x74\x65\144" : ''; goto drtb2; pGUxd: $dept_result = mysqli_query($connection, $dept_query); goto Z7Sl3; wvQnD: include "\56\x2e\57\x2e\56\x2f\166\x69\145\167\x73\57\x64\145\146\141\165\154\x74\57\x73\x69\144\145\142\141\162\137\141\x64\x6d\x69\x6e\56\x70\150\x70"; goto Q51wv; QHln2: ?>
</datalist></div><div class="col-md-6"><label class="form-label">Jabatan <span class="text-danger">*</span></label> <input class="form-control"value="<?php  goto FZPdY; SDcOh: echo htmlspecialchars($edit_user["\x65\155\x61\x69\x6c"] ?? ''); goto Fmzdc; vOPpV: if ($_SERVER["\x52\105\x51\x55\x45\123\124\x5f\x4d\x45\x54\110\x4f\x44"] === "\120\117\x53\124") { $nama_lengkap = mysqli_real_escape_string($connection, $_POST["\156\x61\155\141\x5f\x6c\145\x6e\147\153\x61\160"]); $email = mysqli_real_escape_string($connection, $_POST["\x65\155\x61\151\154"]); $no_telepon = mysqli_real_escape_string($connection, $_POST["\x6e\x6f\137\164\x65\154\x65\160\x6f\x6e"]); $departemen = mysqli_real_escape_string($connection, $_POST["\x64\145\x70\141\x72\x74\145\x6d\145\x6e"]); $jabatan = mysqli_real_escape_string($connection, $_POST["\152\141\x62\x61\x74\x61\x6e"]); $jenis_pengguna = mysqli_real_escape_string($connection, $_POST["\152\145\x6e\151\x73\137\x70\145\156\147\147\x75\156\141"]); if (empty($nama_lengkap) || empty($departemen)) { $error = "\x4e\x61\x6d\141\40\x6c\145\156\x67\153\141\x70\40\144\141\156\x20\x64\x65\x70\x61\x72\164\x65\x6d\x65\156\40\164\151\144\141\x6b\x20\142\x6f\x6c\145\x68\x20\x6b\x6f\163\157\156\147"; } else { $update_query = "\12\40\x20\x20\x20\x20\40\40\x20\x20\x20\40\x20\x55\120\104\101\124\105\40\165\163\x65\162\163\40\123\105\x54\x20\xa\x20\x20\x20\x20\x20\40\x20\40\40\x20\x20\40\40\40\40\x20\x6e\x61\x6d\x61\x5f\154\145\x6e\x67\153\x61\x70\x20\x3d\x20\x27{$nama_lengkap}\x27\x2c\xa\40\40\x20\x20\x20\x20\x20\40\x20\40\x20\x20\40\40\40\40\x65\x6d\141\x69\x6c\x20\75\40\47{$email}\47\x2c\xa\x20\x20\40\x20\40\40\x20\40\40\x20\x20\40\x20\40\40\x20\x6e\157\137\164\145\x6c\x65\160\157\156\40\x3d\x20\47{$no_telepon}\x27\x2c\xa\x20\x20\x20\x20\40\x20\40\40\40\x20\40\40\x20\40\40\x20\144\x65\160\x61\162\x74\x65\155\x65\x6e\40\x3d\40\47{$departemen}\47\x2c\xa\x20\x20\x20\x20\40\40\40\x20\40\40\x20\x20\40\40\40\40\x6a\141\x62\141\x74\x61\156\x20\75\40\x27{$jabatan}\47\x2c\xa\x20\x20\x20\x20\x20\x20\40\40\x20\x20\x20\x20\x20\x20\40\40\152\x65\156\151\x73\137\160\145\156\x67\147\165\156\141\40\75\x20\47{$jenis_pengguna}\47\xa\x20\40\40\x20\40\x20\x20\x20\40\40\x20\x20\127\110\x45\122\x45\x20\165\x73\x65\162\137\x69\144\40\75\x20{$user_id}\12\40\x20\x20\x20\x20\40\40\x20"; if (mysqli_query($connection, $update_query)) { $success = "\125\x73\x65\162\x20\x62\x65\x72\x68\141\163\x69\154\x20\x64\x69\x70\145\x72\142\x61\x72\x75\151"; $result = mysqli_query($connection, "\123\x45\x4c\x45\103\x54\x20\52\x20\x46\x52\117\115\40\x75\163\145\x72\x73\40\127\110\105\x52\x45\x20\x75\163\x65\x72\137\x69\x64\40\75\40{$user_id}"); $edit_user = mysqli_fetch_assoc($result); } else { $error = "\105\162\x72\x6f\x72\x3a\40" . mysqli_error($connection); } } } goto xMj7G; EGz7N: ?>
"name="nama_lengkap"required></div></div><div class="row mb-3"><div class="col-md-6"><label class="form-label">Email</label> <input class="form-control"value="<?php  goto SDcOh; YfRmf: echo htmlspecialchars($edit_user["\x6e\157\137\164\145\154\x65\x70\157\156"] ?? ''); goto NppbE; FZPdY: echo htmlspecialchars($edit_user["\x6a\141\142\141\164\x61\156"] ?? ''); goto nEfD8; F_5sN: if (!$user_id) { header("\x4c\x6f\143\141\164\x69\x6f\x6e\72\40\x69\156\x64\145\170\56\x70\150\x70"); die; } goto sYT41; QFdRv: $role_class = "\x72\157\154\145\x2d" . ($edit_user["\162\x6f\x6c\x65"] === "\x61\x64\x6d\151\x6e" ? "\x61\x64\155\x69\x6e" : "\163\164\141\x66\x66"); goto CpBPK; Fmzdc: ?>
"name="email"type="email"></div><div class="col-md-6"><label class="form-label">No. Telepon</label> <input class="form-control"value="<?php  goto YfRmf; gHUaP: echo htmlspecialchars($edit_user["\156\x61\155\141\x5f\x6c\145\x6e\x67\153\141\160"]); goto EGz7N; xMj7G: $dept_query = "\123\105\114\105\103\x54\40\104\x49\x53\x54\111\x4e\x43\x54\x20\144\145\160\x61\x72\x74\145\155\x65\156\40\106\x52\x4f\115\x20\165\163\x65\162\x73\40\127\x48\x45\x52\x45\40\144\145\160\141\x72\164\145\155\x65\x6e\x20\111\x53\40\x4e\117\x54\40\116\x55\114\114\x20\117\x52\x44\x45\122\40\x42\x59\x20\144\x65\160\x61\162\x74\145\x6d\145\x6e"; goto pGUxd; OO_pL: echo ucfirst($edit_user["\x73\164\141\x74\x75\x73"]); goto ckZNE; NppbE: ?>
"name="no_telepon"type="tel"></div></div><div class="row mb-3"><div class="col-md-6"><label class="form-label">Departemen <span class="text-danger">*</span></label> <input class="form-control"value="<?php  goto VEx89; drtb2: ?>
>Administrator</option></select> <small class="text-muted d-block mt-2"><strong>Staff Biasa:</strong> Hanya bisa melihat barang<br><strong>Kepala Departemen:</strong> Bisa membuat surat peminjaman<br><strong>Kepala Inventaris:</strong> Bisa approve/reject surat peminjaman<br><strong>Administrator:</strong> Akses penuh ke sistem</small></div><div class="col-md-6"><label class="form-label">Role (System)</label><div class="form-control"style="background:#f8f9fa;border:1px solid #dee2e6"><?php  goto QFdRv; c29Z3: ?>
>Staff Biasa</option><option value="kepala_departemen"<?php  goto BDX1d; hPetA: ?>
>Kepala Departemen</option><option value="kepala_inventaris"<?php  goto eA42X; fTtpY: require_once __DIR__ . "\57\56\x2e\x2f\x2e\x2e\x2f\143\x6f\x6e\x66\151\x67\x2f\144\x61\x74\141\142\141\163\145\x2e\x70\150\160"; goto ijORw; GiXRE: ?>
"><?php  goto OO_pL; Z7Sl3: $departments = array(); goto yM3Q8; NgKCR: require_once __DIR__ . "\57\x2e\x2e\x2f\x2e\56\57\154\x69\142\57\141\x75\164\x68\56\x70\x68\x70"; goto eqUkH; hc66l: echo $edit_user["\152\x65\156\151\163\137\x70\145\x6e\147\147\165\x6e\x61"] === "\x73\164\x61\x66\x66" ? "\x73\145\154\x65\143\x74\145\x64" : ''; goto c29Z3; Q51wv: ?>
<main class="col-md-9 main-content ms-sm-auto px-md-4 py-4"><div class="d-flex align-items-center justify-content-between mb-4"><div><h2 class="mb-1">Edit User</h2><nav aria-label="breadcrumb"><ol class="mb-0 breadcrumb"><li class="breadcrumb-item"><a href="../../index.php">Home</a></li><li class="breadcrumb-item"><a href="index.php">Users</a></li><li class="breadcrumb-item active">Edit</li></ol></nav></div></div><?php  goto EM_YN; efVWn: ?>
>Kepala Inventaris</option><option value="admin"<?php  goto Kuv_6; eqUkH: requireAdmin(); goto pZKi0; OO32q: echo htmlspecialchars($edit_user["\165\x73\145\162\x6e\x61\155\x65"]); goto u74GM; Kwl1k: session_start(); goto fTtpY; M5Kop: ?>
<!doctypehtml><html lang="id"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1"name="viewport"><title>Edit User - Inventaris Kantor</title><link href="../../assets/css/style.css"rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"rel="stylesheet"><style>.role-badge{display:inline-block;padding:5px 10px;border-radius:20px;font-size:12px;font-weight:500}.role-staff{background-color:#e3f2fd;color:#1976d2}.role-kepala{background-color:#fff3e0;color:#f57c00}.role-inventaris{background-color:#f3e5f5;color:#7b1fa2}.role-admin{background-color:#ffebee;color:#c62828}</style></head><body><div class="container-fluid"><div class="row"><?php  goto wvQnD; yM3Q8: while ($row = mysqli_fetch_assoc($dept_result)) { $departments[] = $row["\x64\145\x70\141\x72\164\x65\155\x65\156"]; } goto M5Kop; n2M4f: $success = ''; goto vOPpV; BDX1d: echo $edit_user["\x6a\x65\156\x69\x73\137\x70\x65\156\147\147\x75\x6e\141"] === "\153\x65\160\x61\x6c\141\x5f\x64\145\160\x61\x72\164\145\x6d\145\x6e" ? "\x73\145\154\145\143\164\145\x64" : ''; goto hPetA; ijORw: require_once __DIR__ . "\x2f\x2e\x2e\57\56\56\57\154\151\142\57\146\165\156\x63\164\x69\x6f\x6e\163\56\x70\x68\160"; goto NgKCR; SsW6z: if (!$edit_user) { header("\x4c\x6f\x63\x61\164\151\x6f\x6e\x3a\x20\151\x6e\x64\x65\170\56\160\x68\160"); die; } goto DlR9H; IjU2n: foreach ($departments as $dept) { ?>
<option value="<?php  echo htmlspecialchars($dept); ?>
"><?php  } goto QHln2; DlR9H: $error = ''; goto n2M4f; pZKi0: $user = getCurrentUser(); goto XqEO1; kAR7w: $edit_user = mysqli_fetch_assoc($result); goto SsW6z; eA42X: echo $edit_user["\152\145\156\151\x73\x5f\160\x65\156\x67\147\x75\x6e\141"] === "\153\x65\160\141\154\x61\137\x69\156\166\145\156\x74\141\162\151\163" ? "\163\x65\154\x65\143\x74\x65\x64" : ''; goto efVWn; K0Bik: echo $edit_user["\163\x74\141\x74\165\163"] === "\141\x63\164\151\x76\x65" ? "\x73\165\x63\143\x65\x73\163" : "\x64\x61\156\147\145\x72"; goto GiXRE; u74GM: ?>
"disabled> <small class="text-muted">Username tidak dapat diubah</small></div><div class="col-md-6"><label class="form-label">Nama Lengkap <span class="text-danger">*</span></label> <input class="form-control"value="<?php  goto gHUaP; XqEO1: $user_id = (int) ($_GET["\151\144"] ?? 0); goto F_5sN; sBnN3: ?>
</div><small class="text-muted">Role diatur terpisah oleh sistem</small></div></div><div class="row mb-3"><div class="col-md-6"><label class="form-label">Status</label><div class="form-control"style="background:#f8f9fa;border:1px solid #dee2e6"><span class="badge bg-<?php  goto K0Bik; eODfN: ?>
"name="departemen"required list="departments"><datalist id="departments"><?php  goto IjU2n; nEfD8: ?>
"name="jabatan"required placeholder="misal: Kepala Departemen HR"></div></div><div class="row mb-3"><div class="col-md-6"><label class="form-label">Jenis Pengguna <span class="text-danger">*</span></label> <select class="form-select"name="jenis_pengguna"required><option value="">-- Pilih Jenis Pengguna --</option><option value="staff"<?php  goto hc66l; sYT41: $query = "\x53\105\114\105\103\124\x20\x2a\40\x46\x52\117\x4d\x20\165\x73\x65\x72\163\x20\x57\110\105\x52\105\x20\165\163\145\x72\x5f\x69\144\40\75\40{$user_id}"; goto z_JPH; z_JPH: $result = mysqli_query($connection, $query); goto kAR7w; VEx89: echo htmlspecialchars($edit_user["\x64\x65\160\141\x72\164\145\155\x65\x6e"]); goto eODfN; CpBPK: echo "\74\163\160\x61\x6e\40\x63\154\x61\163\x73\x3d\x22\162\x6f\154\145\55\x62\x61\x64\x67\x65\x20" . $role_class . "\42\76" . ucfirst($edit_user["\162\x6f\154\145"]) . "\x3c\57\x73\x70\x61\156\x3e"; goto sBnN3; EM_YN: if ($success) { ?>
<div class="alert alert-dismissible fade show alert-success"role="alert"><i class="fas fa-check-circle"></i><?php  echo $success; ?>
<button class="btn-close"type="button"data-bs-dismiss="alert"></button></div><?php  } goto W0YvP; W0YvP: if ($error) { ?>
<div class="alert alert-dismissible fade show alert-danger"role="alert"><i class="fas fa-exclamation-circle"></i><?php  echo $error; ?>
<button class="btn-close"type="button"data-bs-dismiss="alert"></button></div><?php  } goto XwfsZ; ckZNE: ?>
</span></div></div></div><div class="d-flex gap-2"><button class="btn btn-primary"type="submit"><i class="fas fa-save"></i> Simpan Perubahan</button> <a href="index.php"class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Kembali</a></div></form></div></div><div class="alert alert-info"><i class="fas fa-info-circle"></i> <strong>Info:</strong> Ubah "Jenis Pengguna" untuk menentukan role pengguna dalam sistem surat peminjaman.</div></main></div></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script></body></html>